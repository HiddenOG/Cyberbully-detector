<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>CyberShield Mini Social Feed</title>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
<style>
.flagged { border-left: 5px solid red; padding-left: 10px; }
img.post-img { max-width: 100%; margin-top: 10px; border-radius: 5px; }
.comment-flagged { background-color: #fff3cd; }
</style>
</head>
<body class="bg-light">

<!-- Navbar -->
<nav class="navbar navbar-expand-lg navbar-dark bg-primary">
    <div class="container">
        <a class="navbar-brand fw-bold" href="/">CyberShield</a>
        <div class="d-flex gap-2">
            <a class="btn btn-light btn-sm" href="/">Home</a>
            <a class="btn btn-light btn-sm" href="/paste">Paste</a>
            <a class="btn btn-light btn-sm" href="/chatbot">Chatbot</a>
            <a class="btn btn-light btn-sm" href="/facebook">Facebook</a>
            <a class="btn btn-light btn-sm" href="/facebook/live">Feed</a>
            <a class="btn btn-light btn-sm" href="/actions">Actions</a>
            <a class="btn btn-light btn-sm" href="/help">Help</a>
        </div>
    </div>
</nav>

<div class="container py-4">
<h1 class="text-center mb-4">CyberShield Mini Social Feed</h1>

<!-- New Post Form -->
<form method="POST" enctype="multipart/form-data" class="card p-3 mb-4 shadow-sm">
    <input class="form-control mb-2" name="author" placeholder="Your name">
    <textarea class="form-control mb-2" name="text" placeholder="What's on your mind?" required></textarea>
    <input type="file" name="image" class="form-control mb-2">
    <button type="submit" class="btn btn-primary">Post</button>
</form>

<!-- Posts -->
{% for post in posts|reverse %}
<div class="card mb-3 {% if post.flagged %}flagged{% endif %}">
    <div class="card-body">
        <h5>{{ post.author }}</h5>
        <p>{{ post.text }}</p>
        {% if post.image %}
            <img src="{{ url_for('static', filename='uploads/' + post.image) }}" class="post-img">
        {% endif %}
        <div class="mt-2">
            <a href="{{ url_for('like_post', post_id=post.id) }}" class="btn btn-sm btn-outline-primary">üëç {{ post.likes }}</a>
            <a href="{{ url_for('share_post', post_id=post.id) }}" class="btn btn-sm btn-outline-success">üîÅ {{ post.shares }}</a>
        </div>

        <!-- Comments -->
        <div class="mt-3">
            {% for comment in post.comments %}
                <div class="border p-2 mb-1 {% if comment.flagged %}comment-flagged{% endif %}">
                    <strong>{{ comment.author }}</strong>: {{ comment.text }}
                </div>
            {% endfor %}
            <form method="POST" action="{{ url_for('add_comment', post_id=post.id) }}" class="d-flex mt-2">
                <input class="form-control me-2" name="author" placeholder="Your name">
                <input class="form-control me-2" name="comment" placeholder="Add a comment" required>
                <button class="btn btn-sm btn-primary">Comment</button>
            </form>
        </div>

        <!-- Recommended Actions for flagged posts -->
        {% if post.flagged %}
        <div class="alert alert-warning mt-3">
            ‚ö† This post was flagged for harmful content. <a href="/actions" class="alert-link">View actions</a>.
        </div>
        {% endif %}
    </div>
</div>
{% endfor %}
</div>
</body>
</html>

